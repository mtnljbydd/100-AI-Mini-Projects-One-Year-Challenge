# YOLOv8n模型检测本地视频项目

## 项目简介

本项目基于YOLOv8n轻量级目标检测模型，实现了本地视频和图片的目标检测功能。项目提供了简洁易用的脚本，支持自定义模型加载、实时目标检测和结果可视化，适用于个人技术学习、功能测试及非盈利性的技术研讨场景。

## 项目结构

```
yolov8n模型检测本地视频/
├── video_detect.py        # 视频目标检测脚本
├── img_detect.py          # 图片目标检测脚本
├── check_labels.py        # 模型标签检查工具
├── yolov8n.pt             # YOLOv8n预训练模型
├── 声明.txt               # 代码分享声明
├── 【2】个人矩阵.txt       # 个人信息
└── README.md              # 项目说明文档
```

## 环境要求

| 依赖项 | 版本要求 | 安装命令 |
|-------|---------|----------|
| Python | 3.7+ | 系统安装 |
| OpenCV | 4.0+ | `pip install opencv-python` |
| Ultralytics | 8.0+ | `pip install ultralytics` |
| PyTorch | 2.0+ | `pip install torch torchvision` |

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

如果没有requirements.txt文件，请执行以下命令：

```bash
pip install opencv-python ultralytics torch torchvision
```

### 2. 视频目标检测

1. **准备工作**：
   - 将需要检测的视频文件放入项目目录
   - 将训练好的模型文件（如best.pt）放入项目目录

2. **修改配置**：
   编辑`video_detect.py`文件，修改以下配置：

   ```python
   # ========== 核心配置：务必确认模型文件名是你自己训练的！ ==========
   model_name = "your_model.pt"  # 修改为你的模型文件名
   video_name = "your_video.mp4"  # 修改为你的视频文件名
   output_name = "output_detected.mp4"  # 输出视频文件名
   ```

3. **运行脚本**：

   ```bash
   python video_detect.py
   ```

4. **查看结果**：
   - 检测完成后，标注视频会保存为`output_detected.mp4`
   - 控制台会显示详细的检测统计信息

### 3. 图片目标检测

1. **准备工作**：
   - 将需要检测的图片放入项目目录
   - 将训练好的模型文件放入项目目录

2. **修改配置**：
   编辑`img_detect.py`文件，修改以下配置：

   ```python
   # ========== 核心：直接写文件名（模型/图片都在utills目录下） ==========
   model_name = r"your_model.pt"       # 模型文件名
   image_name = r"your_image.jpg"      # 图片文件名
   output_name = "output.jpg"          # 结果保存文件名
   ```

3. **运行脚本**：

   ```bash
   python img_detect.py
   ```

4. **查看结果**：
   - 检测完成后，标注图片会保存为`output.jpg`

### 4. 模型标签检查

1. **运行脚本**：

   ```bash
   python check_labels.py your_model.pt
   ```

2. **查看结果**：
   - 控制台会显示模型中包含的标签信息
   - 确认标签是否与你的训练数据一致

## 技术实现

### 核心功能模块

1. **视频检测模块**：
   - 支持GPU加速推理，提高检测速度
   - 自动处理视频编码问题，确保输出视频兼容性
   - 逐帧检测并实时标注目标
   - 提供详细的检测统计信息

2. **图片检测模块**：
   - 支持单张图片的快速检测
   - 针对Windows环境优化，避免MPS报错
   - 自动保存标注结果

3. **模型标签检查模块**：
   - 检查模型文件中的标签信息
   - 适配YOLO模型的标签存储格式
   - 提供详细的标签列表

### 技术亮点

1. **易于使用**：
   - 脚本结构清晰，配置简单
   - 提供详细的错误提示和使用指导
   - 支持直接在本地运行，无需复杂的环境配置

2. **功能完整**：
   - 同时支持视频和图片的目标检测
   - 提供模型标签检查工具，确保模型正确
   - 支持自定义模型的加载和使用

3. **性能优化**：
   - 视频检测支持GPU加速，提高推理速度
   - 图片检测针对Windows环境进行了优化
   - 视频处理过程中提供进度反馈

4. **可靠性**：
   - 完善的错误处理机制，确保脚本稳定运行
   - 视频编码问题的修复，提高输出视频的兼容性
   - 模型文件验证，避免加载错误的模型

## 注意事项

1. **模型选择**：
   - 本项目默认提供的`yolov8n.pt`是官方预训练模型，可识别常见物体
   - 如需检测特定目标，请使用自定义训练的模型
   - 自定义模型应确保包含正确的标签信息

2. **硬件要求**：
   - 视频检测支持GPU加速，建议使用具有CUDA支持的显卡
   - CPU环境下也可运行，但检测速度会较慢

3. **视频格式**：
   - 支持常见的视频格式（如.mp4、.avi等）
   - 如遇到编码问题，脚本会自动尝试不同的编码格式

4. **使用限制**：
   - 本项目仅用于个人技术学习、功能测试及非盈利性的技术研讨场景
   - 请在获取代码后的24小时内，主动删除本地设备中存储的代码副本
   - 严禁用于商业运营、产品开发、付费服务等任何以直接或间接获取经济利益为目的的活动

## 常见问题

### 1. 模型加载失败

**可能原因**：
- 模型文件不存在
- 模型文件损坏
- 模型文件不是合法的PyTorch文件

**解决方案**：
- 确认模型文件路径正确
- 检查模型文件是否完整
- 使用`check_labels.py`工具验证模型文件

### 2. 视频编码错误

**可能原因**：
- 输出视频编码格式不支持
- 系统缺少相应的编码器

**解决方案**：
- 脚本会自动尝试不同的编码格式
- 如仍有问题，请尝试使用较短的视频进行测试

### 3. 检测结果不准确

**可能原因**：
- 模型与检测目标不匹配
- 置信度阈值设置不当
- 视频质量较差

**解决方案**：
- 使用针对特定目标训练的模型
- 调整`video_detect.py`中的`conf`参数
- 确保视频清晰，光线充足

## 免责声明

本项目所发布的所有代码内容，均是在技术研究与交流的目的下，结合AI工具辅助编写完成的示例代码，其核心用途限定于个人技术学习、功能测试及非盈利性的技术研讨场景。

严禁任何组织或个人将本项目分享的代码用于商业运营、产品开发、付费服务等任何以直接或间接获取经济利益为目的的活动；同时请您在获取代码后的24小时内，主动删除本地设备中存储的代码副本，避免因非合规使用产生的风险。

我们始终倡导尊重原创、合法使用技术资源的原则，强烈建议您根据自身实际需求自主研发适配的原创代码，或通过官方授权、合法合规的渠道获取并使用正版技术资源，共同维护健康的技术创作与分享环境。

## 联系方式

- 抖音账号：从 0 至 1（日常分享实操、效率工具教程）
- 微信公众号：从 0 至 1（可通过该渠道获取完整代码包及EXE程序）
- 博客网站：[www.from0to1.cn](https://www.from0to1.cn)（持续更新实战教程、技术干货内容）
- GitHub账号：[https://github.com/mtnljbydd](https://github.com/mtnljbydd)（开源更多实用工具脚本及项目工程）

若您认为本项目所分享的代码内容存在侵犯您合法权益的情形，请通过以上联系方式提交书面说明及相关证明材料，我们会在收到信息后的3个工作日内启动核查工作，并根据核实结果及时采取删除、修改等对应的处置措施。
