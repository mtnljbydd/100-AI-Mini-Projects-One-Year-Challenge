# æœ¬åœ°æŒä¹…åŒ–ç§‘å­¦è®¡ç®—å™¨

ä¸€æ¬¾åŸºäº Node.js (Express) + Vue3 (Vite) + SQLite çš„å…¨æ ˆç§‘å­¦è®¡ç®—å™¨åº”ç”¨ï¼Œæ”¯æŒç²¾å‡†å››åˆ™è¿ç®—ï¼ˆå«æ‹¬å·ä¼˜å…ˆçº§ï¼‰å’Œå†å²è®°å½•åŒç«¯æŒä¹…åŒ–å­˜å‚¨ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ§® **ç²¾å‡†è¿ç®—**ï¼šæ”¯æŒæ•´æ•°/æµ®ç‚¹æ•°çš„åŠ å‡ä¹˜é™¤å››åˆ™è¿ç®—ï¼Œæ”¯æŒæ‹¬å·ä¼˜å…ˆçº§è¿ç®—
- âœ… **è¾“å…¥æ ¡éªŒ**ï¼šè‡ªåŠ¨æ£€æµ‹è¿ç»­è¿ç®—ç¬¦ã€é™¤é›¶é”™è¯¯ã€æ‹¬å·ä¸åŒ¹é…ç­‰éæ³•è¾“å…¥
- ğŸ’¾ **åŒç«¯æŒä¹…åŒ–**ï¼šå‰ç«¯ localStorage ç¼“å­˜ + åç«¯ SQLite æ•°æ®åº“ï¼Œç¡®ä¿æ•°æ®æ°¸ä¸ä¸¢å¤±
- ğŸ“œ **å†å²è®°å½•**ï¼šè‡ªåŠ¨ä¿å­˜æ¯æ¬¡è®¡ç®—ï¼Œæ”¯æŒæŸ¥è¯¢ã€åˆ é™¤ã€æ¸…ç©ºæ“ä½œ
- âŒ¨ï¸ **åŒè¾“å…¥æ–¹å¼**ï¼šæ”¯æŒé¼ æ ‡ç‚¹å‡»æŒ‰é”®å’Œé”®ç›˜å¿«æ·è¾“å…¥
- ğŸ¨ **æç®€ç•Œé¢**ï¼šç®€æ´ç¾è§‚çš„ UI è®¾è®¡ï¼Œæ”¯æŒæµ…è‰²/æ·±è‰²æ¨¡å¼åˆ‡æ¢
- ğŸš€ **å…¨æœ¬åœ°è¿è¡Œ**ï¼šæ— éœ€ç½‘ç»œè¿æ¥ï¼ŒSQLite æ•°æ®åº“æ–‡ä»¶å¯éšé¡¹ç›®è¿ç§»

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **Node.js** + **Express** - è½»é‡çº§ Web æœåŠ¡å™¨
- **SQLite3** - æœ¬åœ°æ•°æ®åº“æŒä¹…åŒ–
- **CORS** - è·¨åŸŸèµ„æºå…±äº«

### å‰ç«¯
- **Vue 3** (Composition API) - æ¸è¿›å¼ JavaScript æ¡†æ¶
- **Vite** - ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·
- **çº¯ CSS** - æ—  UI åº“ä¾èµ–ï¼Œæç®€å®ç°

## ğŸ“ é¡¹ç›®ç»“æ„

```
calculate/
â”œâ”€â”€ backend/                    # Express åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ server.js              # Express æœåŠ¡å™¨å…¥å£
â”‚   â”œâ”€â”€ db.js                  # SQLite æ•°æ®åº“åˆå§‹åŒ–ä¸æ“ä½œ
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ history.js         # å†å²è®°å½• CRUD API è·¯ç”±
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ frontend/                   # Vue3 + Vite å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.js            # Vue åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ App.vue            # æ ¹ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ Calculator.vue # è®¡ç®—å™¨ä¸»ç•Œé¢
â”‚   â”‚   â”‚   â””â”€â”€ HistoryPanel.vue # å†å²è®°å½•é¢æ¿
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ calculator.js  # è¡¨è¾¾å¼è®¡ç®—å¼•æ“
â”‚   â”‚   â”‚   â””â”€â”€ storage.js     # localStorage ç¼“å­˜ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ composables/
â”‚   â”‚   â”‚   â””â”€â”€ useHistory.js  # å†å²è®°å½•ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â”‚       â”œâ”€â”€ main.css       # å…¨å±€æ ·å¼
â”‚   â”‚       â””â”€â”€ theme.css      # æ·±è‰²/æµ…è‰²ä¸»é¢˜
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ vite.config.js
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ database/                   # SQLite æ•°æ®åº“æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ calculator.db          # SQLite æ•°æ®åº“æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 14.0.0
- npm >= 6.0.0

### å®‰è£…ä¾èµ–

#### åç«¯ä¾èµ–

```bash
cd backend
npm install
```

#### å‰ç«¯ä¾èµ–

```bash
cd frontend
npm install
```

### å¼€å‘ç¯å¢ƒè¿è¡Œ

#### æ–¹å¼ä¸€ï¼šåˆ†åˆ«å¯åŠ¨ï¼ˆæ¨èï¼‰

**ç»ˆç«¯ 1 - å¯åŠ¨åç«¯æœåŠ¡ï¼š**

**Bash/CMDï¼š**
```bash
cd backend
npm run dev
```

**PowerShellï¼š**
```powershell
cd backend
npm run dev
```

åç«¯æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:3000`

**ç»ˆç«¯ 2 - å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼š**

**Bash/CMDï¼š**
```bash
cd frontend
npm run dev
```

**PowerShellï¼š**
```powershell
cd frontend
npm run dev
```

å‰ç«¯å¼€å‘æœåŠ¡å™¨å°†è¿è¡Œåœ¨ `http://localhost:5173`

#### æ–¹å¼äºŒï¼šç»Ÿä¸€å¯åŠ¨ï¼ˆéœ€è¦å®‰è£… concurrentlyï¼‰

**Bash/CMDï¼š**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
npm install -g concurrently

# åŒæ—¶å¯åŠ¨å‰åç«¯
concurrently "cd backend && npm run dev" "cd frontend && npm run dev"
```

**PowerShellï¼š**
```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•
npm install -g concurrently

# åŒæ—¶å¯åŠ¨å‰åç«¯
concurrently "cd backend; npm run dev" "cd frontend; npm run dev"
```

### ç”Ÿäº§ç¯å¢ƒæ„å»º

#### 1. æ„å»ºå‰ç«¯

```bash
cd frontend
npm run build
```

æ„å»ºäº§ç‰©å°†è¾“å‡ºåˆ° `backend/public/` ç›®å½•

#### 2. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨

**Bash/CMDï¼š**
```bash
cd backend
NODE_ENV=production npm start
```

**PowerShellï¼š**
```powershell
cd backend
$env:NODE_ENV="production"
npm start
```

æœåŠ¡å™¨å°†è¿è¡Œåœ¨ `http://localhost:3000`ï¼ŒåŒæ—¶æä¾›å‰ç«¯é™æ€æ–‡ä»¶å’Œ API æœåŠ¡ã€‚

## ğŸ“– API æ–‡æ¡£

### å†å²è®°å½• API

#### GET `/api/history`
è·å–æ‰€æœ‰å†å²è®°å½•ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "expression": "2+3*4",
      "result": "14",
      "timestamp": "2024-01-01T12:00:00.000Z"
    }
  ]
}
```

#### POST `/api/history`
åˆ›å»ºå†å²è®°å½•

**è¯·æ±‚ä½“ï¼š**
```json
{
  "expression": "2+3*4",
  "result": "14"
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "expression": "2+3*4",
    "result": "14",
    "timestamp": "2024-01-01T12:00:00.000Z"
  }
}
```

#### DELETE `/api/history/:id`
åˆ é™¤å•æ¡å†å²è®°å½•

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

#### DELETE `/api/history`
æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "æ¸…ç©ºæˆåŠŸ"
}
```

## ğŸ¯ åŠŸèƒ½è¯´æ˜

### è¿ç®—åŠŸèƒ½

- **å››åˆ™è¿ç®—**ï¼šæ”¯æŒ `+`ã€`-`ã€`*`ã€`/` å››ç§åŸºæœ¬è¿ç®—
- **æ‹¬å·ä¼˜å…ˆçº§**ï¼šæ”¯æŒä½¿ç”¨ `()` æ”¹å˜è¿ç®—ä¼˜å…ˆçº§
- **æµ®ç‚¹æ•°è¿ç®—**ï¼šè‡ªåŠ¨å¤„ç†å°æ•°è¿ç®—ï¼Œæœ€å¤§ä¿ç•™ 10 ä½æœ‰æ•ˆæ•°å­—
- **è´Ÿæ•°æ”¯æŒ**ï¼šæ”¯æŒè´Ÿæ•°è¾“å…¥å’Œè®¡ç®—ï¼ˆå¦‚ `-5 + 3`ï¼‰
- **è¾“å…¥æ ¡éªŒ**ï¼š
  - ç¦æ­¢è¿ç»­è¿ç®—ç¬¦ï¼ˆå¦‚ `++`ã€`*/`ï¼‰
  - æ‹¬å·å¿…é¡»åŒ¹é…
  - é™¤é›¶æ£€æŸ¥
  - è¡¨è¾¾å¼ä¸èƒ½ä»¥è¿ç®—ç¬¦ç»“å°¾

### å†å²è®°å½•åŠŸèƒ½

- **è‡ªåŠ¨ä¿å­˜**ï¼šæ¯æ¬¡æˆåŠŸè®¡ç®—åè‡ªåŠ¨ä¿å­˜åˆ° localStorage å’Œ SQLite
- **åŒç«¯æŒä¹…åŒ–**ï¼š
  - **å‰ç«¯ç¼“å­˜**ï¼šlocalStorage æä¾›å¿«é€ŸæŸ¥è¯¢
  - **åç«¯æŒä¹…åŒ–**ï¼šSQLite æ•°æ®åº“ç¡®ä¿é•¿æœŸå­˜å‚¨
- **æ“ä½œæ”¯æŒ**ï¼š
  - æŸ¥çœ‹æ‰€æœ‰å†å²è®°å½•ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰
  - åˆ é™¤å•æ¡è®°å½•
  - æ‰¹é‡æ¸…ç©ºæ‰€æœ‰è®°å½•
  - æ‰‹åŠ¨åˆ·æ–°åŒæ­¥

### äº¤äº’åŠŸèƒ½

- **æŒ‰é”®è¾“å…¥**ï¼šç‚¹å‡»è®¡ç®—å™¨æŒ‰é’®è¾“å…¥
- **é”®ç›˜æ”¯æŒ**ï¼š
  - æ•°å­—é”®ï¼š`0-9`
  - è¿ç®—ç¬¦ï¼š`+`ã€`-`ã€`*`ã€`/`
  - æ‹¬å·ï¼š`(`ã€`)`
  - ç­‰å·ï¼š`Enter` æˆ– `=`
  - æ¸…é™¤ï¼š`Escape` æˆ– `Delete`
  - å›åˆ ï¼š`Backspace`
- **è§†è§‰åé¦ˆ**ï¼šæŒ‰é”®ç‚¹å‡»åŠ¨ç”»å’Œæ‚¬åœæ•ˆæœ
- **æ·±è‰²æ¨¡å¼**ï¼šæ”¯æŒæµ…è‰²/æ·±è‰²ä¸»é¢˜åˆ‡æ¢ï¼ˆè‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿåå¥½ï¼‰

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®

æ•°æ®åº“æ–‡ä»¶ä½ç½®ï¼š`database/calculator.db`

æ•°æ®åº“è¡¨ç»“æ„ï¼š
```sql
CREATE TABLE calculations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    expression TEXT NOT NULL,
    result TEXT NOT NULL,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
)
```

### ç«¯å£é…ç½®

- **åç«¯æœåŠ¡**ï¼šé»˜è®¤ç«¯å£ `3000`ï¼Œå¯é€šè¿‡ç¯å¢ƒå˜é‡ `PORT` ä¿®æ”¹
- **å‰ç«¯å¼€å‘æœåŠ¡å™¨**ï¼šé»˜è®¤ç«¯å£ `5173`ï¼Œå¯åœ¨ `vite.config.js` ä¸­ä¿®æ”¹

### ç¯å¢ƒå˜é‡

```bash
# åç«¯ç«¯å£
PORT=3000

# ç”Ÿäº§ç¯å¢ƒæ ‡è¯†
NODE_ENV=production
```

## ğŸ“ å¼€å‘è¯´æ˜

### è¡¨è¾¾å¼è®¡ç®—ç®—æ³•

ä½¿ç”¨ **ä¸­ç¼€è½¬åç¼€ï¼ˆé€†æ³¢å…°è¡¨è¾¾å¼ï¼‰** ç®—æ³•å®ç°æ‹¬å·ä¼˜å…ˆçº§ï¼š

1. **ä¸­ç¼€è½¬åç¼€**ï¼šå°†ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼ï¼ˆä½¿ç”¨ Shunting Yard ç®—æ³•ï¼‰
2. **åç¼€è®¡ç®—**ï¼šä½¿ç”¨æ ˆç»“æ„è®¡ç®—åç¼€è¡¨è¾¾å¼
3. **ç»“æœæ ¼å¼åŒ–**ï¼šå¤„ç†ç²¾åº¦ã€ç§‘å­¦è®¡æ•°æ³•ç­‰

### æ•°æ®æŒä¹…åŒ–ç­–ç•¥

- **å†™å…¥ç­–ç•¥**ï¼šå…ˆå†™å…¥ localStorageï¼ˆå¿«é€Ÿåé¦ˆï¼‰ï¼Œå†å¼‚æ­¥å†™å…¥åç«¯ï¼ˆæ•°æ®ä¿éšœï¼‰
- **è¯»å–ç­–ç•¥**ï¼šä¼˜å…ˆä» localStorage è¯»å–ï¼ˆå¿«é€Ÿå“åº”ï¼‰ï¼Œé¦–æ¬¡åŠ è½½æˆ–ç¼“å­˜å¤±æ•ˆæ—¶åŒæ­¥åç«¯
- **åŒæ­¥ç­–ç•¥**ï¼šåˆ é™¤æ“ä½œåŒæ­¥æ›´æ–°ä¸¤ç«¯æ•°æ®

## ğŸ› å¸¸è§é—®é¢˜

### Q: æ•°æ®åº“æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

A: æ•°æ®åº“æ–‡ä»¶ä½äº `database/calculator.db`ï¼Œé¦–æ¬¡è¿è¡Œåç«¯æœåŠ¡æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºã€‚

### Q: å¦‚ä½•è¿ç§»æ•°æ®åº“ï¼Ÿ

A: ç›´æ¥å¤åˆ¶ `database/calculator.db` æ–‡ä»¶åˆ°æ–°é¡¹ç›®çš„ `database/` ç›®å½•å³å¯ã€‚

### Q: æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åå†å²è®°å½•ä¼šä¸¢å¤±å—ï¼Ÿ

A: ä¸ä¼šã€‚æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åªä¼šæ¸…é™¤ localStorageï¼Œå†å²è®°å½•ä»ä¿å­˜åœ¨ SQLite æ•°æ®åº“ä¸­ï¼Œé‡æ–°åŠ è½½åº”ç”¨åä¼šä»åç«¯åŒæ­¥æ¢å¤ã€‚

### Q: å¦‚ä½•ä¿®æ”¹ç«¯å£ï¼Ÿ

A: 
- åç«¯ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ `PORT=æ–°ç«¯å£` æˆ–ä¿®æ”¹ `backend/server.js`
- å‰ç«¯ï¼šä¿®æ”¹ `frontend/vite.config.js` ä¸­çš„ `server.port`

## ğŸ“„ è®¸å¯è¯

MIT License


## ğŸ“± ä¸ªäººçŸ©é˜µ

> - æŠ–éŸ³è´¦å·ï¼šä» 0 è‡³ 1ï¼ˆæ—¥å¸¸åˆ†äº«å®æ“ã€æ•ˆç‡å·¥å…·æ•™ç¨‹ï¼‰
> - å¾®ä¿¡å…¬ä¼—å·ï¼šä» 0 è‡³ 1ï¼ˆå¯é€šè¿‡è¯¥æ¸ é“è·å–å®Œæ•´ä»£ç åŒ…åŠEXEç¨‹åºï¼‰
> - åšå®¢ç½‘ç«™ï¼š[www.from0to1.cn](https://www.from0to1.cn)ï¼ˆæŒç»­æ›´æ–°å®æˆ˜æ•™ç¨‹ã€æŠ€æœ¯å¹²è´§å†…å®¹ï¼‰
> - GitHubè´¦å·ï¼š[https://github.com/mtnljbydd](https://github.com/mtnljbydd)ï¼ˆå¼€æºæ›´å¤šå®ç”¨å·¥å…·è„šæœ¬åŠé¡¹ç›®å·¥ç¨‹ï¼‰

---

**äº«å—è®¡ç®—ï¼Œæ•°æ®æ°¸ä¸ä¸¢å¤±ï¼** ğŸ‰